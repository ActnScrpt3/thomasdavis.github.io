<!DOCTYPE html>
<html>
<head>
	<title>Thomas Davis - Blog</title>
	<link href="http://alexgorbatchev.com/pub/sh/current/styles/shThemeDefault.css" rel="stylesheet" type="text/css" />
	<link href="http://alexgorbatchev.com/pub/sh/current/styles/shBrushJScript.css" rel="stylesheet" type="text/css" />
	<link href="http://alexgorbatchev.com/pub/sh/current/styles/shBrushXml.css" rel="stylesheet" type="text/css" />
	<link href="http://alexgorbatchev.com/pub/sh/current/styles/shCore.css" rel="stylesheet" type="text/css" />
	<script src="http://alexgorbatchev.com/pub/sh/current/scripts/shCore.js" type="text/javascript"></script>
	<script src="http://alexgorbatchev.com/pub/sh/current/scripts/shAutoloader.js" type="text/javascript"></script>
	<script src="http://alexgorbatchev.com/pub/sh/current/scripts/shBrushJScript.js" type="text/javascript"></script>
	<script src="http://alexgorbatchev.com/pub/sh/current/scripts/shBrushXml.js" type="text/javascript"></script>
	<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.4/jquery.min.js"></script>
	<style type="text/css">
		body, ul { padding: 0; margin: 0; }
		body { font-family: 'Arial'; }
		#container { width: 760px; margin: auto; }
		h1 {  font-size: 3em;  }
		h3 { color: #444; }
		#topmenu {  height: 15px; border-bottom: 1px solid #996699;	padding: 5px; }
		#topmenu ul { list-style: none; }
		#topmenu li { float: left; margin-left: 15px; font-size: 13px;}
	</style>
</head>

<body>
<div id="topmenu">
	<ul>
	<li><a href="../index.html">home</a></li>
	<li><a href="https://github.com/thomasdavis">my repos</a></li>
	<li><a href="/about.html">about me</a></li>
	<li><a href="http://twitter.com/#!/iamjessicagomes" target="_blank" alt="will load in new window, please marry me">hot woman (SFW)</a></li>
	</ul>
	<ul style="float: right; margin-right: 15px;">
	
	<li>thomas davis - <a href="http://twitter.com/neutralthoughts">follow me on twitter</a> or don't</li>
	</ul>
</div>
<section id="container">


	<article class="blog">
		
		<h2>restful ajax web app basics ( using Backbone.js lol )</h2>
		
		<p>Don't want to be circle jerking too hard but todays tutorial will be using Backbone.js again.
		   After using Gmail and other apps such as Clicky for so long it made me sad to see my web apps
		   always refreshing the page and looking chunky.</p>
		<p>Before I continue with the tutorial heres just a few pros of using a fully ajax app with a restful interface.
		<ul style="margin-left: 40px;">
		<li>Less HTTP request</li>
		<li>Minimize the size of requested pages by always requesting JSON</li>
		<li>Lets you build ajax interfaces which are fast and responsive</li>
		<li>Request are already JSON so if you ever need to build an API, its straight forward</li>
		<li>Google invented #! aka the hashbang</li>
		<li>!flash</li>
		</ul></p>
		<p>I was excited the first time I wrote a fully ajax app and with the advent of the google hashbang, you should be able to build your websites with pure ajax calls now also  </p>	
		 <h3>How to implement restful ajax with Backbone.js</h3>
		<p>Backbone.js implements two classes called Controller and History.   Using just these two classes we can construct
		the entire backbone of our restful app.</p>
		<p>To make a fully ajax website we need to use the hashtag, which up until this point has been used predominatly for anchor tags.
		   Browsers don't trigger any page refreshes with hashtags and using Javascript we can detect when the # location changes.
		   Instead of triggering the default behavior of finding an anchor, we insead load custom Javascript.</p>
		<p>
		Below is all the HTML we will be using today.  Also note the inclusion of underscore.js, its a depdendecy of backbone.js and brings
		alot of power to the table.   I have simply set up four links that we are going to load</p>
		<pre class='brush: html js'>
			&lt;!DOCTYPE html>
			&lt;html>
			&lt;head>
				&lt;title>I have a back bone&lt;/title>
			&lt;/head>
			&lt;body>

			&lt;ul id="menu">
			&lt;li>&lt;a href="#animals/dog">Dogs&lt;/a>&lt;/li>
			&lt;li>&lt;a href="#animals/cat">cats&lt;/a>&lt;/li>
			&lt;li>&lt;a href="#shop">Shops&lt;/a>&lt;/li>
			&lt;li>&lt;a href="#gangster">Gangsters&lt;/a>&lt;/li>
			&lt;/ul>
			&lt;div id="content-pane">No content loaded&lt;/div>

			&lt;script src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.4/jquery.min.js">&lt;/script>
			&lt;script src="http://ajax.cdnjs.com/ajax/libs/underscore.js/1.1.4/underscore-min.js">&lt;/script>
			&lt;script src="http://ajax.cdnjs.com/ajax/libs/backbone.js/0.3.3/backbone-min.js">&lt;/script>
			&lt;/body>
			&lt;/html>


      </pre>
      <p>For those of you who are lazy the full example can be viewed <a href="http://thomasdavis.github.com/examples/restful-app/" target="_blank">here</a> and downloaded <a href="https://github.com/thomasdavis/thomasdavis.github.com/tree/master/examples/restful-app" target="_blank">here</a></p>
		<h3>Setting up the controller</h3>
		<p>Below is the documented code that will run the restful ajax app.  Note that I have included a service called openkeyval.org which is simply
		a free service for storing key pair values.

		</p><p> If the el(element) specified
		does not exist, Backbone.js will attempt to create it.</p>
		<pre class='brush: js'>
			(function ($) {
				
				var restfulApp = Backbone.Controller.extend({
					restfulUrl: "http://api.openkeyval.org/", //This is a free service to store key pair values
					
					//Routes tell the app what to do 
					routes: {
					"animals/:animal":          "animalAction",  //This matches app/animals/* and assigns * to a variable called "animal"
					"*page":                 	"defaultAction", //This simply matches any urls that weren't caught above and assigns it to "page"
					},
					
					defaultAction: function( page ){
						//Once the default action is called we want to construct a link to our restful service
						var restfulPageUrl = this.restfulUrl + page + "page" //http://api.openkeyval.org/gangsterpage
						//Now we have a url lets get the data
						this.loadRestfulData( restfulPageUrl );
					},
					animalAction: function( animal ) {
						//Once the default action is called we want to construct a link to our restful service
						var restfulPageUrl = this.restfulUrl + animal + "page" //http://api.openkeyval.org/dogpage
						//Now we have a url lets get the data
						this.loadRestfulData( restfulPageUrl );
					},
					loadRestfulData: function( pageUrl ){
						//Set the content pane to a loading screen
						$("#content-pane").text( "loading data..." );
						//Load the data in using jQuerys ajax call
						$.ajax({
							url: pageUrl,
							dataType: "jsonp",
							success: function(data){
								//Once we receive the data, set it to the content pane.
								$("#content-pane").text( data );
							}
						});	
					}

				});
				
				var app = new restfulApp;
				//Initiate a new history and controller class
				Backbone.emulateHTTP = true;
				Backbone.emulateJSON = true 
				Backbone.history.start();

			})(jQuery);
      </pre> 
     
     <h2><a href="http://thomasdavis.github.com/examples/restful-app/" target="_blank">Demo</a></h2>
     <h2><a href="https://github.com/thomasdavis/thomasdavis.github.com/tree/master/examples/restful-app" target="_blank">Source</a></h2>
	<h3>Conclusion</h3>
	<p>
	Tutorial not finished
	</p>
	  <span class="st_twitter_vcount" displayText="Tweet"></span><span class="st_facebook_vcount" displayText="Share"></span><span class="st_email_vcount" displayText="Email"></span><span class="st_sharethis_vcount" displayText="Share"></span>
<script type="text/javascript" src="http://w.sharethis.com/button/buttons.js"></script><script type="text/javascript">stLight.options({publisher:'bdee6d8c-ed9a-4867-90f6-011704c29ee3'});</script>	</article>
	

	<script type="text/javascript">
		SyntaxHighlighter.all()
	</script>
<script>
var idcomments_acct = 'e6c0e0096f8106ea52c674a85b26ecf9';
var idcomments_post_id;
var idcomments_post_url;
</script>
<span id="IDCommentsPostTitle" style="display:none"></span>
<script type='text/javascript' src='http://www.intensedebate.com/js/genericCommentWrapperV2.js'></script>
</section>
<script src="http://static.getclicky.com/js" type="text/javascript"></script>
<script type="text/javascript">try{ clicky.init(66379121); }catch(err){}</script>
<noscript><p><img alt="Clicky" width="1" height="1" src="http://in.getclicky.com/66379121ns.gif" /></p></noscript>

</body>
</html>
